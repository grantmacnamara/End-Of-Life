<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Report Page</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <h1>Applications Going Out of Date within Six Months</h1>
    <a href="/" class="btn btn-primary">Home</a>
    <table class="table">
        <thead>
            <tr>
                <th>Application</th>
                <th>Latest Version</th>
                <th>Release Date</th>
                <th>End of Life</th>
            </tr>
        </thead>
        <tbody>
            {% for app in applications %}
                {% set six_months_from_today = datetime.utcnow() + timedelta(days=180) %}
                {% if app.end_of_life and app.end_of_life != 'N/A' and app.end_of_life != true %}
                    {% if app.end_of_life == true %}
                        {% set eol_date = six_months_from_today %}
                    {% else %}
                        {% set eol_date = datetime.strptime(app.end_of_life, '%Y-%m-%d') %}
                    {% endif %}
                    {% if eol_date <= six_months_from_today %}
                        <tr>
                            <td>{{ app.name }}</td>
                            <td>{{ app.latest_version }}</td>
                            <td>{{ app.release_date }}</td>
                            <td>{{ app.end_of_life }}</td>
                        </tr>
                    {% endif %}
                {% endif %}
            {% endfor %}
        </tbody>
    </table>
    
</body>
</html>
